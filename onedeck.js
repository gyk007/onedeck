!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.onedeck=t():e.onedeck=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners={}}var t,r,o;return t=e,(r=[{key:"$$on",value:function(e,t){this._listeners[e]||(this._listeners[e]={},this._listeners[e].eventProperty={},this._listeners[e].eventProperty.isOnOnce=!1,this._listeners[e].data=[]),this._listeners[e].data.push(t)}},{key:"$$onOnce",value:function(e,t){this.on(e,t),this._listeners[e].eventProperty.isOnOnce=!0}},{key:"$$off",value:function(e,t){this._listeners[e].data=this._listeners[e].data.filter((function(e){return e!==t}))}},{key:"$$offAll",value:function(){this._listeners={}}},{key:"$$emit",value:function(e,t){var r=this;this._listeners[e]&&this._listeners[e].data?this._listeners[e].data.forEach((function(n){r._listeners[e].eventProperty.isOnOnce&&r.$$off(e,r._listeners[e].data[0]),n(t)})):console.error("No such event:",e)}},{key:"install",value:function(e){e._listeners=this._listeners,e.$$on=this.$$on,e.$$off=this.$$off,e.$$onOnce=this.$$onOnce,e.$$emit=this.$$emit}}])&&n(t.prototype,r),o&&n(t,o),e}();function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,e);var t,r,n,o=c(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),e=o.call(this),u.instances=u.instances||{},u.instances[e.constructor.name]?s(e,u.instances[e.constructor.name]):(u.instances[e.constructor.name]=l(e),e)}return t=u,(r=[{key:"eventHandler",value:function(){}},{key:"init",value:function(){}},{key:"destroy",value:function(){}},{key:"dispatcher",value:function(){}},{key:"mounted",value:function(){}}])&&a(t.prototype,r),n&&a(t,n),u}(o);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,u=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,u=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw u}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t,r,n,o,u,a){try{var i=e[u](a),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,o)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var u=e.apply(t,r);function a(e){p(u,n,o,a,i,"next",e)}function i(e){p(u,n,o,a,i,"throw",e)}a(void 0)}))}}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k(e);if(t){var o=k(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){return!t||"object"!==$(t)&&"function"!=typeof t?j(e):t}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(u,e);var t,r,n,o=v(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=o.call(this))._initGlobalModules=h(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object.keys(t.$$config.modules).filter((function(e){return t.$$config.modules[e].global})),n=0;case 2:if(!(n<r.length)){e.next=8;break}return e.next=5,t._createModule(r[n],t.$$config.modules[r[n]]);case 5:n++,e.next=2;break;case 8:case"end":return e.stop()}}),e)}))),t._createModule=function(){var e=h(regeneratorRuntime.mark((function e(r,n){var o,u,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._modules[r]){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t._import(n.module);case 4:if((o=e.sent)&&o.default){e.next=7;break}throw new SyntaxError("Error load module: ".concat(r));case 7:if(o=o.default,t._modules[r]=new o,t._modules[r].$$global=n.global,t._modules[r].$$rout=t.$$rout.bind(j(t)),t._modules[r].$$gemit=t.$$emit.bind(j(t)),t._modules[r].$$config=t.$$config,t._modules[r].$$layoutName=n.layout,t._modules[r].$$embed={},!n.embed){e.next=32;break}u=Object.keys(n.embed),a=0;case 18:if(!(a<u.length)){e.next=32;break}return e.next=21,t._import(n.embed[u[a]].module);case 21:if((i=e.sent)&&i.default){e.next=24;break}throw new SyntaxError("Error load module: ".concat(u[a]));case 24:i=i.default,t._modules[r].$$embed[u[a]]=new i,t._modules[r].$$embed[u[a]].$$rout=t.$$rout.bind(j(t)),t._modules[r].$$embed[u[a]].$$gemit=t.$$emit.bind(j(t)),t._modules[r].$$embed[u[a]].$$config=t.$$config;case 29:a++,e.next=18;break;case 32:t._modules[r].$$global&&(t._modules[r].init(r),Object.keys(t._modules[r].$$embed).forEach((function(e){return t._modules[r].$$embed[e].init(r)})));case 33:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),t._createLayout=function(){var e=h(regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._layouts[r]){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t._import(r);case 4:if((n=e.sent)&&n.default){e.next=7;break}throw new SyntaxError("Error load module: ".concat(r));case 7:n=n.default,t._layouts[r]=new n,t._layouts[r].$$rout=t.$$rout.bind(j(t)),t._layouts[r].$$gemit=t.$$emit.bind(j(t)),t._layouts[r].$$config=t.$$config;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t._initModule=function(){var e=h(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.module[0],o=t.$$config.modules,n){e.next=5;break}return t.$$rout({path:t.$$config.mainModule}),e.abrupt("return");case 5:if(o[n]){e.next=9;break}return t.$$rout({path:t.$$config.module404}),console.error("no such module:",n),e.abrupt("return");case 9:if(!o[n].global){e.next=13;break}return t.$$rout({path:t.$$config.module404}),console.error("global module:",n),e.abrupt("return");case 13:if(!o[n].layout||o[n].layout!==t.$$currentLayout.name){e.next=17;break}t.$$currentLayout.obj.dispatcher(r.module,r.state,r.queryParam),e.next=34;break;case 17:if(!o[n].layout){e.next=32;break}return t._destroyModule(),t._destroyLayout(),e.prev=20,e.next=23,t._createLayout(o[n].layout);case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(20),console.error(e.t0);case 28:t.$$currentLayout={name:o[n].layout,obj:t._layouts[o[n].layout]},t.$$currentLayout.obj.init(r.module,r.state,r.queryParam),e.next=34;break;case 32:t._destroyModule(),t._destroyLayout();case 34:if(!t.$$currentModule.name||t.$$currentModule.name!==n){e.next=38;break}t._dispatcherModule(r.module,r.state,r.queryParam),e.next=51;break;case 38:return t._destroyModule(),e.prev=39,e.next=42,t._createModule(n,o[n]);case 42:e.next=47;break;case 44:e.prev=44,e.t1=e.catch(39),console.error(e.t1);case 47:t.$$currentModule={name:n,obj:t._modules[n]},t.$$currentModule.obj.init(r.module,r.state,r.queryParam),Object.keys(t.$$currentModule.obj.$$embed).forEach((function(e){return t.$$currentModule.obj.$$embed[e].init(r.module,r.state,r.queryParam)})),t._dispatcherModule(r.module,r.state,r.queryParam);case 51:r.pushState&&t.$$config.historyApi&&window.history.pushState(r.state,n,r.path),t._mounted();case 53:case"end":return e.stop()}}),e,null,[[20,25],[39,44]])})));return function(t){return e.apply(this,arguments)}}(),t._import=e.import,e.import=null,t.$$config=e,t.$$currentModule={},t.$$currentLayout={},t._modules={},t._layouts={},t._urlState={},t._initGlobalModules().then((function(){t._eventHandler();var e=t._getModuleFromUrl(t.$$config.historyApi?document.location.pathname:document.location.hash);t.init(e.url,e.params),t._initModule({module:e.url,queryParam:e.params,path:document.location.pathname})})).catch((function(e){console.error("Error init global module",e)})),t}return t=u,(r=[{key:"init",value:function(){}},{key:"eventHandler",value:function(){}},{key:"mounted",value:function(){}},{key:"dispatcher",value:function(){}},{key:"$$rout",value:function(e){var t=this.$$config.rootPath?this.$$config.rootPath+e.path:e.path;if(t=t.replace(/\/\//,"/"),this.$$config.historyApi){var r=this._getModuleFromUrl(t);this._initModule({module:r.url,path:t,state:e.state,pushState:!0,queryParam:r.params})}else this._urlState[t]=e.state,document.location.hash=t}},{key:"_mounted",value:function(){var e=this;this.mounted(this.$$currentModule,this.$$currentLayout),Object.keys(this._modules).filter((function(t){return e._modules[t].$$global})).forEach((function(t){e._modules[t].mounted(e.$$currentModule,e.$$currentLayout),Object.keys(e._modules[t].$$embed).forEach((function(r){return e._modules[t].$$embed[r].mounted(e.$$currentModule,e.$$currentLayout)}))})),this.$$currentLayout.obj&&this.$$currentLayout.obj.mounted(this.$$currentModule,this.$$currentLayout),this.$$currentModule.obj&&(this.$$currentModule.obj.mounted(this.$$currentModule,this.$$currentLayout),Object.keys(this.$$currentModule.obj.$$embed).forEach((function(t){return e.$$currentModule.obj.$$embed[t].mounted(e.$$currentModule,e.$$currentLayout)})))}},{key:"_destroyModule",value:function(){var e=this;this.$$currentModule.obj&&(this.$$currentModule.obj.destroy(),Object.keys(this.$$currentModule.obj.$$embed).forEach((function(t){return e.$$currentModule.obj.$$embed[t].destroy()})),this.$$currentModule={})}},{key:"_destroyLayout",value:function(){this.$$currentLayout.obj&&(this.$$currentLayout.obj.destroy(),this.$$currentLayout={})}},{key:"_dispatcherModule",value:function(e,t,r){var n=this;this.dispatcher(e,t,r),Object.keys(this._modules).filter((function(e){return n._modules[e].$$global})).forEach((function(o){n._modules[o].dispatcher(e,t,r),Object.keys(n._modules[o].$$embed).forEach((function(u){return n._modules[o].$$embed[u].dispatcher(e,t,r)}))})),this.$$currentModule.obj&&(this.$$currentModule.obj.dispatcher(e,t,r),Object.keys(this.$$currentModule.obj.$$embed).forEach((function(o){return n.$$currentModule.obj.$$embed[o].dispatcher(e,t,r)})))}},{key:"_getModuleFromUrl",value:function(e){this.$$config.rootPath&&(e=e.replace(this.$$config.rootPath,""));var t=y((e=e.replace(/^[\/, #]/,"")).split("?"),2),r=t[0],n=t[1],o={};return n&&n.split("&").forEach((function(e){var t=y(e.split("="),2),r=t[0],n=t[1];o[r]=n})),{url:r.split("/"),params:o}}},{key:"_eventHandler",value:function(){var e=this;if(this.$$config.historyApi){var t=this._getModuleFromUrl(document.location.pathname);window.addEventListener("popstate",(function(r){return e._initModule({module:t.url,path:document.location.pathname,state:r.state,queryParam:t.params})}))}else{var r=this._getModuleFromUrl(document.location.hash);window.addEventListener("hashchange",(function(){return e._initModule({module:r.url,path:document.location.hash,state:e._urlState[document.location.hash.replace(/^#/,"")],queryParam:r.params})}))}}}])&&b(t.prototype,r),n&&b(t,n),u}(o);t.default={Observable:o,Module:d,RootModule:M}}])}));